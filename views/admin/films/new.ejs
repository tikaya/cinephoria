<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Nouveau film - Cinéphoria</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
</head>
<body class="bg-dark text-light">
  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h3"><i class="fa-solid fa-plus me-2 text-warning"></i> Nouveau film</h1>
      <a href="/admin/films" class="btn btn-outline-light">← Retour</a>
    </div>

    <% if (errors && errors.length) { %>
      <div class="alert alert-warning">
        <ul class="mb-0">
          <% errors.forEach(e => { %><li><%= e.message %></li><% }) %>
        </ul>
      </div>
    <% } %>

    <!-- UNIQUE formulaire (l’autre copie a été supprimée) -->
    <form method="post" action="/admin/films" class="p-3 rounded-3"
          style="background:rgba(12,18,38,.72); border:1px solid rgba(255,255,255,.08);" novalidate>
      <%- include('./_form', { film: null, errors: (errors || []), old: (old || {}) }) %>
      <div class="mt-3 d-flex gap-2">
        <button class="btn btn-warning">
          <i class="fa-solid fa-floppy-disk"></i> Enregistrer
        </button>
        <a href="/admin/films" class="btn btn-outline-light">Annuler</a>
      </div>
    </form>
  </div>

  <script>
    // Focus auto sur le premier champ avec erreur (si présent)
    (function() {
      const warn = document.querySelector('.alert-warning');
      if (warn) {
        const firstInvalid =
          document.querySelector('[name="titre"]') ||
          document.querySelector('[name="genre"]') ||
          document.querySelector('[name="description"]');
        if (firstInvalid) firstInvalid.focus();
      } else {
        const titre = document.querySelector('[name="titre"]');
        if (titre) titre.focus();
      }
    })();
  </script>
</body>
</html>
