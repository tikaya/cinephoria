<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Créer un film – Intranet Employé</title>

  <!-- Fonts + Icons + Bootstrap -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Cinzel:wght@600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <link rel="icon" type="image/png" href="/images/favicon.png">

  <style>
    :root{ --gold:#f5c518; --bg1:#0a0f1f; --bg2:#121829; --ink:#eaeaea; }
    html, body { height:100%; margin:0; padding:0; }
    body{
      display:flex; flex-direction:column; min-height:100vh;
      background: radial-gradient(circle at center, #121829, #0a0f1f 85%);
      background-size: 300% 300%;
      animation: gradientMove 18s ease infinite;
      color: var(--ink);
      font-family: 'Poppins', sans-serif;
      opacity: 0; transition: opacity 1.2s ease;
    }
    body.loaded{ opacity: 1; }
    @keyframes gradientMove{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }
    header, footer{
      width:100%;
      background: rgba(10, 15, 31, 0.85);
      text-align:center;
      padding: 15px 0;
      color: var(--ink);
      font-size: 1rem;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
    }
    footer{ margin-top:auto; }
    main{ flex:1; padding: 0 0 40px; }

    h1{
      font-family: 'Cinzel', serif;
      font-size: 2.3rem;
      color: var(--gold);
      text-shadow: 0 0 12px rgba(245,197,24,0.5), 0 0 25px rgba(0,0,0,0.8);
      text-align:center;
      margin: 32px auto 10px;
      animation: fadeInDown 1.2s ease;
    }
    .subhero{
      max-width: 980px; margin: 0 auto 24px; padding: 10px 16px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(245,197,24,0.35);
      border-radius: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 18px rgba(0,0,0,0.55);
      color: #d7dbeb; text-align:center;
      animation: fadeInUp 1s ease;
    }
    @keyframes fadeInDown{ from{opacity:0; transform: translateY(-20px)} to{opacity:1; transform:none} }
    @keyframes fadeInUp{ from{opacity:0; transform: translateY(20px)} to{opacity:1; transform:none} }

    .module-card{
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(245,197,24,0.35);
      border-radius: 14px;
      backdrop-filter: blur(12px);
      box-shadow: 0 0 25px rgba(0,0,0,0.7);
      color: #fff;
      transition: transform .35s ease, box-shadow .35s ease, border-color .35s ease;
      animation: fadeInUp .9s ease forwards; opacity:0;
      overflow:hidden;
    }
    .module-card.visible{ opacity:1; }
    .module-card .card-header{
      background: rgba(245,197,24,0.08);
      border-bottom: 1px solid rgba(245,197,24,0.25);
      color: var(--gold);
      font-weight: 600;
    }
    .btn-intra{
      background: linear-gradient(45deg, #ff004d, #a700ff);
      color:#fff; border:none; font-weight:700;
      border-radius: 10px; padding: 10px 14px;
      text-shadow: 0 0 6px rgba(0,0,0,0.8);
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .btn-intra:hover{ transform: scale(1.04); box-shadow: 0 0 25px rgba(245,197,24,0.7); }
    .form-label{ color:#e9ecf6; }
    .form-text{ color:#cfd3de !important; }
    .form-control, .form-select{
      background: rgba(255,255,255,0.08); color:#fff; border-color: rgba(245,197,24,0.35);
    }
    .form-control:focus, .form-select:focus{
      background: rgba(255,255,255,0.12); color:#fff; border-color: rgba(245,197,24,0.65);
      box-shadow: 0 0 10px rgba(245,197,24,0.5);
    }
    .breadcrumb a{ color: var(--gold); text-decoration: none; }
    .breadcrumb .active{ color:#d7dbeb; }
  </style>
</head>
<body>
  <header>
    <%- include('partials/header_employe', { currentUser }) %>
  </header>

  <main class="container">
    <nav class="mt-3" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/intranet">Intranet</a></li>
        <li class="breadcrumb-item"><a href="/intranet/films">Films</a></li>
        <li class="breadcrumb-item active" aria-current="page">Créer</li>
      </ol>
    </nav>

    <h1><i class="fa-solid fa-film me-2"></i>Créer un film</h1>
    <p class="subhero">
      <i class="fa-regular fa-circle-check me-1"></i>
      Remplis les informations ci-dessous. Les champs marqués <strong>*</strong> sont obligatoires.
    </p>

    <div class="row justify-content-center">
      <div class="col-12 col-lg-10">
        <article class="card module-card visible">
          <div class="card-header"><i class="fa-solid fa-pen-to-square me-2"></i> Formulaire de création</div>
          <div class="card-body">
            <form method="POST" action="/intranet/films">
              <!-- CSRF -->
              <input type="hidden" name="_csrf" value="<%= csrfToken %>">

              <div class="row g-3">
                <!-- Titre -->
                <div class="col-12 col-md-8">
                  <label for="titre" class="form-label">Titre *</label>
                  <input type="text" id="titre" name="titre" class="form-control" maxlength="150" required
                         value="<%= (old && old.titre) ? old.titre : '' %>">
                  <div class="form-text">150 caractères max.</div>
                </div>

                <!-- Genre -->
                <div class="col-12 col-md-4">
                  <label for="genre" class="form-label">Genre *</label>
                  <input type="text" id="genre" name="genre" class="form-control" maxlength="50" required
                         placeholder="Action, Drame, SF..." value="<%= (old && old.genre) ? old.genre : '' %>">
                </div>

                <!-- Description -->
                <div class="col-12">
                  <label for="description" class="form-label">Description *</label>
                  <textarea id="description" name="description" class="form-control" rows="5" required><%= (old && old.description) ? old.description : '' %></textarea>
                </div>

                <!-- Âge minimum -->
                <div class="col-12 col-md-4">
                  <label for="age_minimum" class="form-label">Âge minimum</label>
                  <input type="number" id="age_minimum" name="age_minimum" class="form-control" min="0"
                         value="<%= (old && old.age_minimum !== undefined) ? old.age_minimum : '' %>">
                </div>

                <!-- Coup de cœur -->
                <div class="col-12 col-md-4 d-flex align-items-end">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="label_coup_de_coeur" name="label_coup_de_coeur" value="true"
                           <%= (old && (old.label_coup_de_coeur === true || old.label_coup_de_coeur === 'true')) ? 'checked' : '' %>>
                    <label class="form-check-label" for="label_coup_de_coeur">Coup de cœur ?</label>
                  </div>
                </div>

                <!-- Affiche URL -->
                <div class="col-12 col-md-8">
                  <label for="affiche_url" class="form-label">Affiche (URL)</label>
                  <input type="url" id="affiche_url" name="affiche_url" class="form-control" placeholder="https://…"
                         value="<%= (old && old.affiche_url) ? old.affiche_url : '' %>">
                  <div class="form-text">Optionnel — colle un lien d’image (CDN, Cloudinary, etc.).</div>
                </div>
              </div>

              <!-- Erreurs (si tu en passes via le contrôleur) -->
              <% if (typeof errors !== 'undefined' && errors.length) { %>
                <div class="alert alert-danger mt-4">
                  <ul class="m-0">
                    <% errors.forEach(e => { %>
                      <li><%= e.msg || e %></li>
                    <% }) %>
                  </ul>
                </div>
              <% } %>

              <div class="d-flex gap-2 mt-4">
                <a href="/intranet/films" class="btn btn-outline-light">
                  <i class="fa-solid fa-arrow-left-long me-1"></i> Annuler
                </a>
                <button type="submit" class="btn btn-intra">
                  <i class="fa-solid fa-floppy-disk me-1"></i> Créer le film
                </button>
              </div>
            </form>
          </div>
        </article>
      </div>
    </div>
  </main>

  <footer>
    <%- include('partials/footer') %>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    window.addEventListener("load", () => { document.body.classList.add("loaded"); });
  </script>
</body>
</html>
